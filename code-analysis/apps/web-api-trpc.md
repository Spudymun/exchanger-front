### –ü—É—Ç—å: apps/web/pages/api/trpc/[trpc].ts

**–ö—Ä–∞—Ç–∫–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ (1 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ)**
Next.js API handler –¥–ª—è tRPC, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–π HTTP endpoint –¥–ª—è –≤—Å–µ—Ö tRPC –ø—Ä–æ—Ü–µ–¥—É—Ä —á–µ—Ä–µ–∑ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –º–∞—Ä—à—Ä—É—Ç.

**–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ (3‚Äì6 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π)**
–§–∞–π–ª —Å–æ–∑–¥–∞–µ—Ç Next.js API handler –∏—Å–ø–æ–ª—å–∑—É—è tRPC –∞–¥–∞–ø—Ç–µ—Ä –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Å–µ—Ö tRPC –∑–∞–ø—Ä–æ—Å–æ–≤ —á–µ—Ä–µ–∑ –µ–¥–∏–Ω—ã–π –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π endpoint. –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π appRouter –∏–∑ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π —á–∞—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å Next.js API routes —Å–∏—Å—Ç–µ–º–æ–π. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é createContext –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏. –í–∫–ª—é—á–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –ø—Ä–æ–±–ª–µ–º –≤ production. –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç type-safe API –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—é –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–æ–º –∏ —Å–µ—Ä–≤–µ—Ä–æ–º —á–µ—Ä–µ–∑ tRPC –ø—Ä–æ—Ç–æ–∫–æ–ª.

**–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ / API (–≤—Å–µ –Ω–∞ 100%)**

- `export default createNextApiHandler(...)` ‚Äî Next.js API handler –¥–ª—è tRPC

**–í—Ö–æ–¥—ã (expected inputs) / –ü–∞—Ä–∞–º–µ—Ç—Ä—ã (–≤—Å–µ –Ω–∞ 100%)**

- HTTP –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ `/api/trpc/[...trpc]` endpoint
- `router: appRouter` ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π tRPC —Ä–æ—É—Ç–µ—Ä —Å –ø—Ä–æ—Ü–µ–¥—É—Ä–∞–º–∏
- `createContext` ‚Äî —Ñ—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞
- `onError` ‚Äî callback –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ tRPC

**–í—ã—Ö–æ–¥—ã / –ü–æ–±–æ—á–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã (–≤—Å–µ –Ω–∞ 100%)**

- HTTP –æ—Ç–≤–µ—Ç—ã —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ tRPC –ø—Ä–æ—Ü–µ–¥—É—Ä
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª—å —Å –ø—É—Ç–µ–º –∏ –¥–µ—Ç–∞–ª—è–º–∏
- –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ (auth, metadata)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö tRPC –æ–ø–µ—Ä–∞—Ü–∏–π (query, mutation, subscription)

**–í–∑–∞–∏–º–æ—Å–≤—è–∑–∏ (–∫—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç / —á—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç) (–≤—Å–µ –Ω–∞ 100%)**

- **–í—ã–∑—ã–≤–∞–µ—Ç—Å—è**: Next.js –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ `/api/trpc/*`
- **–ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç**: `appRouter` –∏–∑ `../../../src/server/trpc`, `createContext` –∏–∑ context –º–æ–¥—É–ª—è
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**: tRPC –∫–ª–∏–µ–Ω—Ç–æ–º –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö –¥–ª—è API –≤—ã–∑–æ–≤–æ–≤
- **–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç**: –≤—Å–µ tRPC –ø—Ä–æ—Ü–µ–¥—É—Ä—ã (auth, exchange, user, etc.)

**–î–æ–º–µ–Ω –¥–∞–Ω–Ω—ã—Ö / —Ç–∏–ø—ã (–≤—Å–µ –Ω–∞ 100%)**

```typescript
interface NextApiHandlerConfig {
  router: typeof appRouter;
  createContext: (opts: CreateNextContextOptions) => Promise<Context>;
  onError: (opts: { path?: string; error: TRPCError }) => void;
}

type TRPCEndpoint = '/api/trpc/[...trpc]';
type HTTPMethods = 'GET' | 'POST' | 'OPTIONS';
```

**–†–∏—Å–∫–∏ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**

- **–°—Ä–µ–¥–Ω–∏–π —Ä–∏—Å–∫**: —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è —Ç–æ—á–∫–∞ –¥–ª—è –≤—Å–µ—Ö API –æ–ø–µ—Ä–∞—Ü–∏–π
- **Error exposure**: –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–∂–µ—Ç —Ä–∞—Å–∫—Ä—ã—Ç—å sensitive –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
- **Rate limiting**: –Ω–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ rate limiting –Ω–∞ —É—Ä–æ–≤–Ω–µ handler
- **Authentication**: –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã createContext
- **CORS**: –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è cross-origin –∑–∞–ø—Ä–æ—Å–æ–≤

**–¢–µ—Å—Ç—ã / —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø–æ–∫—Ä—ã—Ç–∏—é**

- **Integration —Ç–µ—Å—Ç—ã**: –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö tRPC –ø—Ä–æ—Ü–µ–¥—É—Ä —á–µ—Ä–µ–∑ HTTP
- **Error handling —Ç–µ—Å—Ç—ã**: –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ—à–∏–±–æ–∫
- **Context —Ç–µ—Å—Ç—ã**: –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- **Performance —Ç–µ—Å—Ç—ã**: –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API endpoint

**–û—Ü–µ–Ω–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (low/medium/high)**
**LOW** - –ø—Ä–æ—Å—Ç–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è tRPC —Å Next.js –±–µ–∑ —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏

**TODO / –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥**

- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å tRPC –∏ Next.js
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –¥–æ–±–∞–≤–∏—Ç—å rate limiting middleware
- üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: —É–ª—É—á—à–∏—Ç—å error logging (—É–±—Ä–∞—Ç—å sensitive –¥–∞–Ω–Ω—ã–µ)
- üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –¥–æ–±–∞–≤–∏—Ç—å CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
