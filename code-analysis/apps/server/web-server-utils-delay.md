### Путь: apps/web/src/server/utils/delay.ts

**Краткое назначение (1 предложение)**

Утилитная функция для создания асинхронных задержек в API endpoints для имитации реальных сетевых запросов.

**Подробное описание (3–6 предложений)**

Файл предоставляет простую Promise-based утилиту для добавления временных задержек в серверные процедуры согласно принципу DRY (Don't Repeat Yourself). Функция используется в различных роутерах для имитации реалистичного времени ответа API, что улучшает пользовательский опыт и позволяет тестировать loading состояния в UI компонентах. Особенно важна в development среде где отсутствуют естественные задержки сети и внешних API сервисов. Реализация через Promise и setTimeout обеспечивает неблокирующее ожидание и интеграцию с async/await паттернами в tRPC процедурах. Централизация логики задержек упрощает управление производительностью и позволяет легко отключать задержки в production.

**Экспортируемые сущности / API**

- `export const createDelay` — асинхронная функция для создания задержки
  - Принимает `ms: number` — время задержки в миллисекундах
  - Возвращает `Promise<void>` — резолвится через указанное время

**Входы (expected inputs) / Параметры**

- `ms: number` — время задержки в миллисекундах (должно быть положительным числом)

**Выходы / Побочные эффекты**

- Возврат Promise который резолвится через указанное время
- Неблокирующая задержка выполнения кода
- Отсутствие побочных эффектов на данные или состояние
- Интеграция с async/await для последовательного выполнения

**Взаимосвязи (кто вызывает / что вызывает)**

Файлы, которые импортируют этот файл:

- `../trpc/routers/auth.ts` — задержки в регистрации и входе в систему
- Другие роутеры, где нужна имитация API задержек
- Любые серверные утилиты требующие асинхронных пауз

Файлы, которые импортируются здесь:

- Отсутствуют — файл использует только нативные Web APIs

**Домен данных / типы**

```typescript
// Сигнатура функции
type CreateDelay = (ms: number) => Promise<void>;

// Типичные значения задержек (из констант)
type DelayValues =
  | typeof AUTH_CONSTANTS.AUTH_REQUEST_DELAY_MS // ~500ms
  | typeof AUTH_CONSTANTS.LOGIN_REQUEST_DELAY_MS // ~300ms
  | typeof API_DELAY_MS // ~200ms
  | typeof ORDER_CREATION_DELAY_MS; // ~1000ms
```

**Риски и безопасность**

- **Performance impact**: Использование в production может замедлить API
- **User experience**: Слишком большие задержки ухудшают UX
- **Resource usage**: Множественные задержки могут увеличить memory usage
- **Testing consistency**: Задержки могут влиять на стабильность тестов
- **Configuration management**: Отсутствие конфигурации для разных сред

**Тесты / рекомендации по покрытию**

- Unit тесты проверки времени выполнения с различными значениями ms
- Performance тесты влияния на общее время ответа API
- Integration тесты использования в реальных роутерах
- Edge case тесты: нулевые значения, отрицательные числа, очень большие задержки

**Оценка сложности (low/medium/high)**

**low** — простая утилитная функция без сложной логики

**TODO / Рефакторинг**

- Добавить конфигурацию для отключения задержек в production
- Реализовать валидацию входных параметров (положительные числа)
- Добавить поддержку отмены задержки через AbortSignal
- Рассмотреть добавление jitter для более реалистичных задержек
- Создать typed константы для стандартных значений задержек
- Добавить логирование для debugging целей
