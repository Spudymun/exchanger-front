/**
 * Performance Configuration
 * Настройки производительности с обоснованием значений
 */

/**
 * Настройки глубины сканирования
 */
export const DEPTH_LIMITS = {
  /**
   * Максимальная глубина для построения дерева компонентов
   * Обоснование: Большинство React проектов имеют вложенность компонентов 3-5 уровней.
   * Глубина 5 покрывает 95% случаев и предотвращает зависание на циклических зависимостях.
   */
  MAX_COMPONENT_DEPTH: 5,

  /**
   * Максимальное количество импортов для обработки
   * Обоснование: Компоненты с >20 импортами обычно нарушают SRP.
   * Ограничение защищает от memory overflow на больших файлах.
   */
  MAX_IMPORTS_PER_COMPONENT: 20,

  /**
   * Пороговое значение для логирования большого количества импортов
   * Обоснование: 5+ импортов может указывать на high coupling
   */
  IMPORTS_WARNING_THRESHOLD: 5,

  /**
   * Максимальная глубина для поиска файлов
   * Обоснование: Защита от бесконечной рекурсии в файловой системе
   */
  MAX_FILE_SEARCH_DEPTH: 10,
} as const;

/**
 * Настройки таймаутов
 */
export const TIMEOUT_CONFIG = {
  /**
   * Полное сканирование проекта (30 секунд)
   * Обоснование: Достаточно для проектов до 10000 компонентов.
   * Основано на бенчмарках: ~3ms на компонент + overhead
   */
  FULL_SCAN: 30000,

  /**
   * Быстрое сканирование без глубокого анализа (20 секунд)
   * Обоснование: Для CI/CD пайплайнов где важна скорость
   */
  FAST_SCAN: 20000,

  /**
   * Минимальное сканирование только основных файлов (15 секунд)
   * Обоснование: Fallback для очень больших проектов
   */
  MINIMAL_SCAN: 15000,

  /**
   * Таймаут для одного компонента (5 секунд)
   * Обоснование: Защита от зависания на сложных компонентах
   */
  SINGLE_COMPONENT: 5000,
} as const;

/**
 * Настройки производительности
 */
export const PERFORMANCE_CONFIG = {
  /**
   * Размер чанка для batch обработки файлов
   * Обоснование: Баланс между memory usage и performance
   */
  FILE_BATCH_SIZE: 50,

  /**
   * Максимальный размер файла для обработки (в байтах)
   * Обоснование: Файлы >1MB обычно сгенерированы или содержат не React код
   */
  MAX_FILE_SIZE: 1024 * 1024, // 1MB

  /**
   * Количество одновременных операций
   * Обоснование: Не перегружать систему, особенно I/O операции
   */
  MAX_CONCURRENT_OPERATIONS: 10,
} as const;

/**
 * Heuristics для определения типов компонентов
 */
export const COMPONENT_HEURISTICS = {
  /**
   * Минимальное количество Tailwind классов для "rich component"
   * Обоснование: Компоненты с >30 классами обычно комплексные UI элементы.
   * Основано на анализе популярных UI библиотек (shadcn/ui, Headless UI)
   */
  MIN_TAILWIND_CLASSES_FOR_RICH_COMPONENT: 30,

  /**
   * Пороговые значения для определения UI компонентов
   */
  UI_DETECTION_THRESHOLDS: {
    /**
     * Количество классов для детекции использования UI компонентов
     * Обоснование: Button из shadcn/ui имеет ~65 классов в CVA,
     * компоненты с >60 классами обычно используют сложные UI элементы
     */
    COMPLEX_UI_COMPONENT: 60,

    /**
     * Порог для компонентов с умеренным количеством стилей
     * Обоснование: Input/Select компоненты обычно имеют 20-50 классов
     */
    MODERATE_UI_COMPONENT: 50,

    /**
     * Порог для инференции Button компонента
     * Обоснование: Button с variant и size обычно имеет 60+ классов
     */
    INFER_BUTTON_THRESHOLD: 60,
  },

  /**
   * Эталонные значения количества классов для UI компонентов
   * Обоснование: Основано на анализе shadcn/ui и популярных библиотек
   */
  UI_COMPONENT_CLASS_ESTIMATES: {
    /**
     * Button: ~65 классов (CVA с вариантами: primary, secondary, размеры, состояния)
     */
    Button: 65,

    /**
     * Input: ~25 классов (base styles + focus + error states)
     */
    Input: 25,

    /**
     * Card: ~15 классов (container + padding + borders + shadows)
     */
    Card: 15,

    /**
     * Dialog: ~30 классов (overlay + content + animations)
     */
    Dialog: 30,

    /**
     * Form: ~20 классов (layout + spacing + validation styles)
     */
    Form: 20,

    /**
     * Select: ~35 классов (trigger + content + item styles)
     */
    Select: 35,

    /**
     * Textarea: ~15 классов (base + resize + states)
     */
    Textarea: 15,

    /**
     * Label: ~10 классов (typography + spacing)
     */
    Label: 10,

    /**
     * Table: ~20 классов (grid + borders + spacing)
     */
    Table: 20,

    /**
     * Notification/Toast: ~60 классов (variants + animations + icons)
     */
    Notification: 60,

    /**
     * Дефолтное значение для неизвестных UI компонентов
     * Обоснование: Средние базовые стили для большинства элементов
     */
    DEFAULT: 15,
  },

  /**
   * Лимиты для анализа и отображения
   */
  ANALYSIS_LIMITS: {
    /**
     * Максимальное количество топ-компонентов для отображения
     * Обоснование: 10 компонентов достаточно для обзора без перегрузки
     */
    TOP_COMPONENTS_LIMIT: 10,

    /**
     * Максимальное количество стилей для "leaf" компонента
     * Обоснование: Leaf компоненты должны быть простыми
     */
    MAX_STYLES_FOR_LEAF: 10,

    /**
     * Максимальное количество стилей для обычного компонента
     * Обоснование: Баланс между функциональностью и простотой
     */
    MAX_STYLES_FOR_REGULAR: 15,
  },

  /**
   * Паттерны имен для UI компонентов
   * Обоснование: Стандартные naming conventions в React экосистеме
   */
  UI_COMPONENT_NAME_PATTERNS: [
    /^(Button|Input|Select|Dialog|Modal|Card|Table)$/,
    /^(Form|Field|Label|Error)$/,
    /^(Header|Footer|Navigation|Sidebar)$/,
    /^(Spinner|Loading|Icon)$/,
  ],

  /**
   * Максимальное количество дочерних компонентов для leaf компонента
   * Обоснование: Leaf компоненты обычно не имеют сложной иерархии
   */
  MAX_CHILDREN_FOR_LEAF_COMPONENT: 3,
} as const;

/**
 * Конфигурация кэширования
 */
export const CACHE_CONFIG = {
  /**
   * Максимальное количество компонентов в кэше
   * Обоснование: Баланс между memory usage и hit rate
   */
  MAX_CACHED_COMPONENTS: 1000,

  /**
   * TTL для кэша файлов (в миллисекундах)
   * Обоснование: Файлы редко меняются во время одного сканирования
   */
  FILE_CACHE_TTL: 300000, // 5 минут
} as const;
