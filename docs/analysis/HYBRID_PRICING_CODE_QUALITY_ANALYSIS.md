# üîç –ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó –ö–ê–ß–ï–°–¢–í–ê –ö–û–î–ê: HYBRID PRICING SYSTEM

> **–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞**: 29 —Å–µ–Ω—Ç—è–±—Ä—è 2025  
> **–ö–æ–º–º–∏—Ç**: `ebd3884` - feat: implement hybrid pricing system with real-time USDT rates  
> **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: Next.js 15 + tRPC + TypeScript + Zustand –≤ Turborepo –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏  
> **–ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è**: –ê–Ω–∞–ª–∏–∑ —á–µ—Ä–µ–∑ git diff + –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üìä –û–ë–©–ê–Ø –û–¶–ï–ù–ö–ê –ö–ê–ß–ï–°–¢–í–ê

**–ò–¢–û–ì–û–í–´–ô –ë–ê–õ–õ: 7.5/10**

### ‚úÖ –°–ò–õ–¨–ù–´–ï –°–¢–û–†–û–ù–´

- –û—Ç–ª–∏—á–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º–æ–π
- –ü–æ–ª–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- –ì—Ä–∞–º–æ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ fallback –ª–æ–≥–∏–∫–∞
- –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è TypeScript
- –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### ‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´

- **–ù–∞—Ä—É—à–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ –≤ SmartPricingService**
- Inline –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ –ª–æ–≥–≥–µ—Ä –≤–º–µ—Å—Ç–æ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
- –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤ (400+ —Å—Ç—Ä–æ–∫)
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Å–µ—Ä–≤–∏—Å–µ

---

## üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ (–ü–†–ò–û–†–ò–¢–ï–¢ 1)

### 1. **SmartPricingService: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è**

**–§–∞–π–ª**: `packages/exchange-core/src/services/smart-pricing-service.ts`  
**–°–µ—Ä—å–µ–∑–Ω–æ—Å—Ç—å**: üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø  
**–°—Ç—Ä–æ–∫–∏**: 1-400+ (–≤–µ—Å—å —Ñ–∞–π–ª)

#### –ü—Ä–æ–±–ª–µ–º—ã:

```typescript
// ‚ùå –ü–†–û–ë–õ–ï–ú–ê 1: Inline logger –≤–º–µ—Å—Ç–æ @repo/utils
private logInfo(message: string, data?: Record<string, unknown>): void {
  console.log(`[SmartPricingService] ${message}`, data ? JSON.stringify(data, null, 2) : '');
}

// ‚ùå –ü–†–û–ë–õ–ï–ú–ê 2: 40+ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –≤–Ω—É—Ç—Ä–∏ –∫–ª–∞—Å—Å–∞ –≤–º–µ—Å—Ç–æ @repo/constants
private readonly config = {
  USDT: {
    staticMargin: 0.003,
    competitiveBuffer: 0.005,
    apiTimeout: 10000,
    fallbackMultiplier: 1.05,
  },
  // ... –µ—â–µ 30+ —Å—Ç—Ä–æ–∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
};

// ‚ùå –ü–†–û–ë–õ–ï–ú–ê 3: –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ 400+ —Å—Ç—Ä–æ–∫ (–ª–∏–º–∏—Ç –ø—Ä–æ–µ–∫—Ç–∞ 50-100)
// ‚ùå –ü–†–û–ë–õ–ï–ú–ê 4: –ù–∞—Ä—É—à–µ–Ω–∏–µ Single Responsibility Principle
```

#### –ù–∞—Ä—É—à–µ–Ω–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –ø—Ä–æ–µ–∫—Ç–∞:

- **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç**: –í—Å–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ `@repo/constants`
- **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è —É—Ç–∏–ª–∏—Ç**: –õ–æ–≥–≥–µ—Ä—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ `@repo/utils`
- **–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤**: –õ–∏–º–∏—Ç 50-100 —Å—Ç—Ä–æ–∫, —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ 400+
- **Single Responsibility**: –ö–ª–∞—Å—Å –¥–µ–ª–∞–µ—Ç API –∑–∞–ø—Ä–æ—Å—ã + –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ + –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É + –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

```typescript
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –†–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–ª–∞—Å—Å–æ–≤
// 1. PricingConfigManager (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
// 2. ApiRateProvider (API –∑–∞–ø—Ä–æ—Å—ã)
// 3. RateCacheManager (–∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ)
// 4. BusinessLogicProcessor (–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞)
// 5. SmartPricingOrchestrator (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è)
```

---

## ‚ö†Ô∏è –ê–†–•–ò–¢–ï–ö–¢–£–†–ù–´–ï –ü–†–û–ë–õ–ï–ú–´ (–ü–†–ò–û–†–ò–¢–ï–¢ 2)

### 2. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Å—Ç–∞–Ω—Ç**

**–§–∞–π–ª—ã**: `packages/constants/src/telegram.ts`, `packages/constants/src/currency.ts`  
**–°–µ—Ä—å–µ–∑–Ω–æ—Å—Ç—å**: üü° –°–†–ï–î–ù–Ø–Ø

#### –ü—Ä–æ–±–ª–µ–º—ã:

```typescript
// ‚ùå –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã —Ä–∞–∑–±—Ä–æ—Å–∞–Ω—ã –ø–æ —Ä–∞–∑–Ω—ã–º —Ñ–∞–π–ª–∞–º
// smart-pricing-service.ts —Å–æ–¥–µ—Ä–∂–∏—Ç 40+ –∫–æ–Ω—Å—Ç–∞–Ω—Ç
// –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ @repo/constants

// ‚úÖ –†–ï–®–ï–ù–ò–ï: packages/constants/src/pricing-config.ts
export const PRICING_CONFIG = {
  USDT: {
    staticMargin: 0.003,
    competitiveBuffer: 0.005,
    apiTimeout: 10000,
    fallbackMultiplier: 1.05,
  },
  // ... –æ—Å—Ç–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
};
```

### 3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ª–æ–≥–≥–µ—Ä–∞**

**–§–∞–π–ª**: `packages/exchange-core/src/services/smart-pricing-service.ts`  
**–°–µ—Ä—å–µ–∑–Ω–æ—Å—Ç—å**: üü° –°–†–ï–î–ù–Ø–Ø

#### –ü—Ä–æ–±–ª–µ–º—ã:

```typescript
// ‚ùå Inline –ª–æ–≥–≥–µ—Ä –≤ –∫–∞–∂–¥–æ–º —Å–µ—Ä–≤–∏—Å–µ
private logInfo(message: string, data?: Record<string, unknown>): void {
  console.log(`[SmartPricingService] ${message}`, data ? JSON.stringify(data, null, 2) : '');
}

// ‚úÖ –†–ï–®–ï–ù–ò–ï: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å @repo/utils/logger
import { createLogger } from '@repo/utils';
const logger = createLogger('SmartPricingService');
```

---

## üü® –ö–ê–ß–ï–°–¢–í–ï–ù–ù–´–ï –£–õ–£–ß–®–ï–ù–ò–Ø (–ü–†–ò–û–†–ò–¢–ï–¢ 3)

### 4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö**

**–§–∞–π–ª—ã**: `apps/web/src/components/exchange/ExchangeContainer.tsx`, `apps/web/src/components/hero-exchange/useHeroExchangeForm.ts`  
**–°–µ—Ä—å–µ–∑–Ω–æ—Å—Ç—å**: üü® –ù–ò–ó–ö–ê–Ø

#### –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ –∫–æ–¥–∞:

```typescript
// ‚úÖ –•–û–†–û–®–û: –ï—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
useEffect(() => {
  if (!fromAmount || !fromCurrency) {
    setToAmount('');
    return;
  }

  let isCancelled = false;

  const calculateAmount = async () => {
    try {
      setIsCalculating(true);
      const amount = await calculateUahAmountAsync(fromAmount, fromCurrency as CryptoCurrency);
      if (!isCancelled) {
        setToAmount(amount.toString());
      }
    } catch (error) {
      if (!isCancelled) {
        console.error('Calculation error:', error);
        setToAmount('');
      }
    } finally {
      if (!isCancelled) {
        setIsCalculating(false);
      }
    }
  };

  calculateAmount();

  return () => {
    isCancelled = true;
  };
}, [fromAmount, fromCurrency]);
```

#### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è:

```typescript
// üîÑ –ú–û–ñ–ù–û –£–õ–£–ß–®–ò–¢–¨: –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
catch (error) {
  if (!isCancelled) {
    logger.error('Calculation error:', error);
    // –î–æ–±–∞–≤–∏—Ç—å toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    toast.error('–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –∫—É—Ä—Å–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.');
    setToAmount('');
  }
}
```

### 5. **–¢–∏–ø–∏–∑–∞—Ü–∏—è –≤ tRPC —Ä–æ—É—Ç–µ—Ä–∞—Ö**

**–§–∞–π–ª—ã**: `apps/web/src/server/trpc/routers/exchange.ts`, `apps/web/src/server/trpc/routers/fiat.ts`  
**–°–µ—Ä—å–µ–∑–Ω–æ—Å—Ç—å**: üü® –ù–ò–ó–ö–ê–Ø

#### –ê–Ω–∞–ª–∏–∑:

```typescript
// ‚úÖ –û–¢–õ–ò–ß–ù–û: –ü–æ–ª–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è
getRates: publicProcedure.query(async (): Promise<{
  rates: HybridExchangeRate[];
  timestamp: Date;
  metadata: PricingMetadata;
}> => {
  // ... implementation
}),

// ‚úÖ –•–û–†–û–®–û: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞
return {
  rates: rates.map(rate => ({
    currency: rate.currency,
    usdRate: rate.usdRate,
    uahRate: rate.uahRate,
    commission: rate.commission,
    lastUpdated: rate.lastUpdated,
    source: rate.source,
    spread: rate.spread,
  })),
  timestamp: new Date(),
  metadata: {
    realTimeCount: rates.filter(r => r.source === 'api').length,
    fallbackCount: rates.filter(r => r.source === 'fallback').length,
    mockCount: rates.filter(r => r.source === 'mock').length,
  }
};
```

---

## üéØ –î–ï–¢–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó –ü–û –§–ê–ô–õ–ê–ú

### **1. packages/exchange-core/src/services/smart-pricing-service.ts**

- **–†–∞–∑–º–µ—Ä**: 400+ —Å—Ç—Ä–æ–∫ ‚ùå (–ª–∏–º–∏—Ç 50-100)
- **–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è ‚ùå (API + –∫–µ—à + –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ + –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)
- **–ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã**: Inline ‚ùå (–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ @repo/constants)
- **–õ–æ–≥–≥–µ—Ä**: Inline ‚ùå (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ @repo/utils)
- **–¢–∏–ø–∏–∑–∞—Ü–∏—è**: –û—Ç–ª–∏—á–Ω–∞—è ‚úÖ
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è ‚úÖ
- **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å**: –•–æ—Ä–æ—à–∞—è ‚úÖ

**–û—Ü–µ–Ω–∫–∞**: 6/10

### **2. packages/exchange-core/src/utils/calculations.ts**

- **–†–∞–∑–º–µ—Ä**: –ü—Ä–∏–µ–º–ª–µ–º—ã–π ‚úÖ
- **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –ü–æ–ª–Ω–∞—è ‚úÖ
- **–ù–æ–≤—ã–µ async —Ñ—É–Ω–∫—Ü–∏–∏**: –ü—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã ‚úÖ
- **Singleton pattern**: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω ‚úÖ
- **–¢–∏–ø–∏–∑–∞—Ü–∏—è**: –û—Ç–ª–∏—á–Ω–∞—è ‚úÖ
- **–ò–º–ø–æ—Ä—Ç—ã**: –ß–∏—Å—Ç—ã–µ ‚úÖ

**–û—Ü–µ–Ω–∫–∞**: 9/10

### **3. apps/web/src/components/exchange/ExchangeContainer.tsx**

- **React hooks**: –ü—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã ‚úÖ
- **Async –æ–±—Ä–∞–±–æ—Ç–∫–∞**: –ì—Ä–∞–º–æ—Ç–Ω–∞—è —Å cleanup ‚úÖ
- **–°–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏**: –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ ‚úÖ
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: –ë–∞–∑–æ–≤–∞—è (–º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å) üü®
- **TypeScript**: –°—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è ‚úÖ
- **Performance**: useEffect —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ ‚úÖ

**–û—Ü–µ–Ω–∫–∞**: 8/10

### **4. apps/web/src/components/hero-exchange/useHeroExchangeForm.ts**

- **Custom hook —Å—Ç—Ä—É–∫—Ç—É—Ä–∞**: –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è ‚úÖ
- **Debouncing**: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å) üü®
- **Error boundaries**: –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã üü®
- **Cleanup**: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π ‚úÖ
- **State management**: –ß–∏—Å—Ç–æ–µ ‚úÖ

**–û—Ü–µ–Ω–∫–∞**: 7/10

### **5. apps/web/src/server/trpc/routers/exchange.ts**

- **tRPC integration**: –ë–µ–∑—É–ø—Ä–µ—á–Ω–∞—è ‚úÖ
- **Error handling**: Comprehensive ‚úÖ
- **Fallback logic**: –ü—Ä–æ–¥—É–º–∞–Ω–Ω–∞—è ‚úÖ
- **Response structure**: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è ‚úÖ
- **Performance**: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã ‚úÖ

**–û—Ü–µ–Ω–∫–∞**: 9/10

### **6. apps/web/src/server/trpc/routers/fiat.ts**

- **–ù–æ–≤—ã–π endpoint**: –ü—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω ‚úÖ
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: –ß–∏—Å—Ç–∞—è ‚úÖ
- **–¢–∏–ø–∏–∑–∞—Ü–∏—è**: –°—Ç—Ä–æ–≥–∞—è ‚úÖ
- **–†–∞–∑–º–µ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π**: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π ‚úÖ

**–û—Ü–µ–Ω–∫–∞**: 9/10

### **7. packages/constants/src/telegram.ts**

- **–ù–æ–≤—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã**: –õ–æ–≥–∏—á–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω—ã ‚úÖ
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞**: –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π ‚úÖ
- **Naming**: –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–π ‚úÖ

**–û—Ü–µ–Ω–∫–∞**: 9/10

### **8. packages/constants/src/currency.ts**

- **–ù–æ–≤—ã–µ —Ç–∏–ø—ã**: –ü—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã ‚úÖ
- **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤**: –ì—Ä–∞–º–æ—Ç–Ω–æ–µ ‚úÖ
- **Backward compatibility**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ ‚úÖ

**–û—Ü–µ–Ω–∫–∞**: 9/10

### **9. apps/web/src/components/ui/sending-info/SendingInfo.tsx**

- **UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç**: –ü—Ä–æ—Å—Ç–æ–π –∏ —á–∏—Å—Ç—ã–π ‚úÖ
- **Props typing**: –°—Ç—Ä–æ–≥–∞—è ‚úÖ
- **React best practices**: –°–æ–±–ª—é–¥–µ–Ω—ã ‚úÖ

**–û—Ü–µ–Ω–∫–∞**: 8/10

### **10. packages/exchange-core/src/services/index.ts**

- **–≠–∫—Å–ø–æ—Ä—Ç—ã**: –ü—Ä–∞–≤–∏–ª—å–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω—ã ‚úÖ
- **Barrel pattern**: –°–æ–±–ª—é–¥–µ–Ω ‚úÖ

**–û—Ü–µ–Ω–∫–∞**: 10/10

---

## üìã –ü–õ–ê–ù –†–ï–§–ê–ö–¢–û–†–ò–ù–ì–ê (–°–¢–†–û–ì–û –ü–û –ü–†–ò–û–†–ò–¢–ï–¢–ê–ú)

### üî¥ –ü–†–ò–û–†–ò–¢–ï–¢ 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

#### 1.1 –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ SmartPricingService –Ω–∞ –∫–ª–∞—Å—Å—ã

```
–°–æ–∑–¥–∞—Ç—å:
‚îú‚îÄ‚îÄ packages/constants/src/pricing-config.ts (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
‚îú‚îÄ‚îÄ packages/utils/src/pricing-logger.ts (–ª–æ–≥–≥–µ—Ä)
‚îú‚îÄ‚îÄ packages/exchange-core/src/services/api-rate-provider.ts (API)
‚îú‚îÄ‚îÄ packages/exchange-core/src/services/rate-cache-manager.ts (–∫–µ—à)
‚îú‚îÄ‚îÄ packages/exchange-core/src/services/business-logic-processor.ts (–ª–æ–≥–∏–∫–∞)
‚îî‚îÄ‚îÄ packages/exchange-core/src/services/smart-pricing-orchestrator.ts (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è)
```

#### 1.2 –í—ã–Ω–æ—Å –∫–æ–Ω—Å—Ç–∞–Ω—Ç –≤ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã

```typescript
// packages/constants/src/pricing-config.ts
export const PRICING_CONFIG = {
  /* –≤—Å–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏–∑ —Å–µ—Ä–≤–∏—Å–∞ */
};

// packages/constants/src/api-endpoints.ts
export const API_ENDPOINTS = {
  /* –≤—Å–µ URL –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ API */
};
```

#### 1.3 –°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ª–æ–≥–≥–µ—Ä–∞

```typescript
// packages/utils/src/logger.ts
export const createLogger = (service: string) => ({
  info: (message: string, data?: unknown) => {
    /* implementation */
  },
  error: (message: string, error?: Error) => {
    /* implementation */
  },
  warn: (message: string, data?: unknown) => {
    /* implementation */
  },
});
```

### üü° –ü–†–ò–û–†–ò–¢–ï–¢ 2: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

#### 2.1 –î–æ–±–∞–≤–ª–µ–Ω–∏–µ Error Boundaries –≤ React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### 2.2 –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

#### 2.3 –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### üü® –ü–†–ò–û–†–ò–¢–ï–¢ 3: –£–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞

#### 3.1 –î–æ–±–∞–≤–ª–µ–Ω–∏–µ debouncing –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ñ–æ—Ä–º—ã

#### 3.2 –£–ª—É—á—à–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

#### 3.3 –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –∑–∞–≥—Ä—É–∑–∫–∏

---

## üß™ –ö–ê–ß–ï–°–¢–í–û –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø

### ‚úÖ –û—Ç–ª–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã:

- Unit —Ç–µ—Å—Ç—ã –¥–ª—è SmartPricingService
- Integration —Ç–µ—Å—Ç—ã –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
- Mock'–∏ –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö API
- Edge cases –ø–æ–∫—Ä—ã—Ç–∏–µ

### üîÑ –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:

- E2E —Ç–µ—Å—Ç—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- Performance —Ç–µ—Å—Ç—ã –¥–ª—è API –Ω–∞–≥—Ä—É–∑–∫–∏
- –¢–µ—Å—Ç—ã –Ω–∞ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å (chaos engineering)

---

## üìà –ú–ï–¢–†–ò–ö–ò –ö–ê–ß–ï–°–¢–í–ê

### Code Complexity

- **SmartPricingService**: üî¥ –í—ã—Å–æ–∫–∞—è (–Ω–µ–æ–±—Ö–æ–¥–∏–º —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥)
- **Calculations**: üü¢ –ù–∏–∑–∫–∞—è
- **React Components**: üü° –°—Ä–µ–¥–Ω—è—è
- **tRPC Routers**: üü¢ –ù–∏–∑–∫–∞—è

### Maintainability Index

- **–û–±—â–∏–π**: 7.5/10
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å**: 6/10 (–∏–∑-–∑–∞ SmartPricingService)
- **Code reusability**: 9/10
- **Error resilience**: 9/10

### Technical Debt

- **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥**: SmartPricingService refactoring
- **–°—Ä–µ–¥–Ω–∏–π –¥–æ–ª–≥**: –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç –∏ –ª–æ–≥–≥–µ—Ä–∞
- **–ù–∏–∑–∫–∏–π –¥–æ–ª–≥**: UI —É–ª—É—á—à–µ–Ω–∏—è –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã

---

## üéØ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï –ò –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### üí° –ì–ª–∞–≤–Ω—ã–µ –≤—ã–≤–æ–¥—ã:

1. **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–ª–∏—á–Ω–∞—è** - —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ
2. **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è** - –Ω–æ–≤—ã–π –∫–æ–¥ —Ö–æ—Ä–æ—à–æ –≤–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ –ø—Ä–æ–µ–∫—Ç
3. **–û–¥–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞** - SmartPricingService –Ω–∞—Ä—É—à–∞–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø—ã –ø—Ä–æ–µ–∫—Ç–∞
4. **–ü–æ–ª–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ –Ω–µ —Å–ª–æ–º–∞–Ω

### üöÄ –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:

1. **–û—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å –¥–ª—è Production** - —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ
2. **–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥** SmartPricingService –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —Å–ø—Ä–∏–Ω—Ç
3. **–°–æ–∑–¥–∞—Ç—å GitHub Issues** –¥–ª—è –∫–∞–∂–¥–æ–π –ø—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏
4. **–î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** API –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### üìä –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞:

**–¢–ï–•–ù–ò–ß–ï–°–ö–û–ï –ö–ê–ß–ï–°–¢–í–û**: 9/10 ‚úÖ  
**–ê–†–•–ò–¢–ï–ö–¢–£–†–ù–ê–Ø –°–û–ì–õ–ê–°–û–í–ê–ù–ù–û–°–¢–¨**: 6/10 ‚ö†Ô∏è  
**–ì–û–¢–û–í–ù–û–°–¢–¨ –ö PRODUCTION**: 8/10 ‚úÖ  
**–ü–û–î–î–ï–†–ñ–ò–í–ê–ï–ú–û–°–¢–¨**: 7/10 üü®

**–û–ë–©–ê–Ø –û–¶–ï–ù–ö–ê: 7.5/10** - –û—Ç–ª–∏—á–Ω–∞—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –æ–¥–Ω–∏–º –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–º –Ω–∞—Ä—É—à–µ–Ω–∏–µ–º, —Ç—Ä–µ–±—É—é—â–∏–º –ø–ª–∞–Ω–æ–≤–æ–≥–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞.

---

## üìù –ß–ï–ö–õ–ò–°–¢ –î–õ–Ø –°–õ–ï–î–£–Æ–©–ò–• –®–ê–ì–û–í

### –ë–ª–∏–∂–∞–π—à–∏–µ –∑–∞–¥–∞—á–∏ (—ç—Ç–∞ –Ω–µ–¥–µ–ª—è):

- [ ] –°–æ–∑–¥–∞—Ç—å GitHub Issues –¥–ª—è –∫–∞–∂–¥–æ–π –ø—Ä–æ–±–ª–µ–º—ã
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ API performance
- [ ] –î–æ–±–∞–≤–∏—Ç—å alerts –¥–ª—è fallback —Ä–µ–∂–∏–º–æ–≤
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π

### –°—Ä–µ–¥–Ω–∏–π —Å—Ä–æ–∫ (—Å–ª–µ–¥—É—é—â–∏–π —Å–ø—Ä–∏–Ω—Ç):

- [ ] –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ SmartPricingService
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ª–æ–≥–≥–µ—Ä–∞
- [ ] –í—ã–Ω–æ—Å –∫–æ–Ω—Å—Ç–∞–Ω—Ç –≤ @repo/constants
- [ ] –î–æ–±–∞–≤–ª–µ–Ω–∏–µ Error Boundaries

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —Ü–µ–ª–∏ (—Å–ª–µ–¥—É—é—â–∏–π –º–µ—Å—è—Ü):

- [ ] –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
- [ ] –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- [ ] –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –Ω–∞ –¥—Ä—É–≥–∏–µ –≤–∞–ª—é—Ç—ã
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—É—Ä—Å–∞–º–∏

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–ª–≥–∞ –Ω–∞ –±—É–¥—É—â–∏–µ —Å–ø—Ä–∏–Ω—Ç—ã.**
